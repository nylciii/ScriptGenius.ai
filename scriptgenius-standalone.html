<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScriptGenius.ai - Video Transcription & Script Generation</title>
    <meta name="description" content="Transform your videos into powerful content with AI-powered transcription and script generation. Upload videos and get professional transcripts and scripts instantly.">
    <meta name="keywords" content="video transcription, AI scripts, content generation, video processing, speech to text">
    <meta name="author" content="ScriptGenius.ai">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        /* Color Palette Variables */
        :root {
          --primary-gold: #FCBB6D;
          --primary-rose: #D8737F;
          --primary-mauve: #AB6C82;
          --primary-slate: #685D79;
          --primary-blue: #475C7A;
          
          --gradient-primary: linear-gradient(135deg, #FCBB6D 0%, #D8737F 50%, #AB6C82 100%);
          --gradient-secondary: linear-gradient(135deg, #AB6C82 0%, #685D79 50%, #475C7A 100%);
          --gradient-background: linear-gradient(135deg, #FCBB6D15 0%, #D8737F10 25%, #AB6C8210 50%, #685D7910 75%, #475C7A15 100%);
        }

        /* Typography */
        body {
          font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
          background: var(--gradient-background);
          min-height: 100vh;
          color: var(--primary-blue);
          line-height: 1.6;
        }

        h1, h2, h3, h4, h5, h6 {
          font-family: 'Playfair Display', Georgia, serif;
          font-weight: 600;
          color: var(--primary-blue);
        }

        .display-4 {
          background: var(--gradient-primary);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
          font-weight: 700;
        }

        /* Card Styling */
        .card {
          border: none;
          border-radius: 1rem;
          box-shadow: 0 10px 30px rgba(71, 92, 122, 0.1);
          backdrop-filter: blur(10px);
          background: rgba(255, 255, 255, 0.95);
          transition: all 0.3s ease;
        }

        .card:hover {
          transform: translateY(-2px);
          box-shadow: 0 15px 40px rgba(71, 92, 122, 0.15);
        }

        .card-header {
          background: var(--gradient-primary);
          color: white;
          border-radius: 1rem 1rem 0 0 !important;
          border: none;
          font-weight: 600;
        }

        /* Button Styling */
        .btn {
          border-radius: 0.75rem;
          font-weight: 500;
          transition: all 0.3s ease;
          border: none;
          position: relative;
          overflow: hidden;
        }

        .btn-primary {
          background: var(--gradient-primary);
          color: white;
          box-shadow: 0 4px 15px rgba(252, 187, 109, 0.3);
        }

        .btn-primary:hover {
          background: var(--gradient-secondary);
          transform: translateY(-1px);
          box-shadow: 0 6px 20px rgba(252, 187, 109, 0.4);
        }

        .btn-primary:disabled {
          background: #e9ecef;
          color: #6c757d;
          transform: none;
          box-shadow: none;
        }

        /* Form Controls */
        .form-control {
          border-radius: 0.75rem;
          border: 2px solid #e9ecef;
          padding: 0.75rem 1rem;
          font-size: 1rem;
          transition: all 0.3s ease;
          background: rgba(255, 255, 255, 0.9);
        }

        .form-control:focus {
          border-color: var(--primary-rose);
          box-shadow: 0 0 0 0.2rem rgba(216, 115, 127, 0.25);
          background: white;
        }

        .form-control-lg {
          padding: 1rem 1.25rem;
          font-size: 1.1rem;
        }

        /* Alert Styling */
        .alert {
          border-radius: 1rem;
          border: none;
          font-weight: 500;
        }

        .alert-danger {
          background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%);
          color: #c62828;
          border-left: 4px solid #f44336;
        }

        .alert-success {
          background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
          color: #2e7d32;
          border-left: 4px solid #4caf50;
        }

        .alert-info {
          background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
          color: #1565c0;
          border-left: 4px solid #2196f3;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
          width: 8px;
        }

        ::-webkit-scrollbar-track {
          background: rgba(171, 108, 130, 0.1);
          border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
          background: var(--gradient-primary);
          border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
          background: var(--gradient-secondary);
        }

        /* Loading Animation */
        @keyframes pulse {
          0% {
            opacity: 1;
            transform: scale(1);
          }
          50% {
            opacity: 0.7;
            transform: scale(1.05);
          }
          100% {
            opacity: 1;
            transform: scale(1);
          }
        }

        .loading-pulse {
          animation: pulse 2s infinite;
        }

        /* Spinner Styling */
        .spinner-border {
          color: var(--primary-rose);
        }

        /* Text Selection */
        ::selection {
          background: var(--primary-gold);
          color: var(--primary-blue);
        }

        /* Focus States */
        .btn:focus,
        .form-control:focus {
          outline: none;
          box-shadow: 0 0 0 0.2rem rgba(216, 115, 127, 0.25);
        }

        /* Responsive Typography */
        @media (max-width: 768px) {
          .display-4 {
            font-size: 2.5rem;
          }
          
          .card {
            margin: 0.5rem;
          }
        }

        /* Gradient Text Effects */
        .gradient-text {
          background: var(--gradient-primary);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
        }

        /* Subtle Animations */
        .fade-in {
          animation: fadeIn 0.6s ease-in;
        }

        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        /* Script Card Styling */
        .script-card {
          border: 1px solid rgba(171, 108, 130, 0.2);
          transition: all 0.3s ease;
          height: 100%;
        }

        .script-card:hover {
          transform: translateY(-2px);
          box-shadow: 0 8px 25px rgba(71, 92, 122, 0.15);
        }

        .script-card .card-header {
          background: linear-gradient(135deg, #FCBB6D20 0%, #D8737F20 100%);
          border-bottom: 1px solid rgba(171, 108, 130, 0.1);
          color: var(--primary-blue);
        }

        .script-card .card-body {
          color: var(--primary-slate);
          line-height: 1.6;
          white-space: pre-wrap;
        }

        /* Loading Spinner */
        .spinner-border-sm {
          width: 1rem;
          height: 1rem;
        }

        /* File Input Hover Effect */
        .form-control:hover {
          border-color: var(--primary-gold);
          background: rgba(252, 187, 109, 0.1);
        }

        /* Badge Styling */
        .badge {
          font-size: 0.9rem;
          font-weight: 500;
        }

        /* Demo Mode Styling */
        .demo-mode {
          background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
          border: 2px solid #ff9800;
          border-radius: 1rem;
          padding: 1rem;
          margin-bottom: 1rem;
        }

        .demo-mode h6 {
          color: #e65100;
          font-weight: 600;
          margin-bottom: 0.5rem;
        }

        .demo-mode p {
          color: #bf360c;
          margin-bottom: 0;
          font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-lg-8">

                <!-- Header Section -->
                <div class="text-center mb-5 fade-in">
                    <h1 class="display-4 fw-bold gradient-text mb-3">ScriptGenius.ai</h1>
                    <p class="lead" style="color: var(--primary-slate); font-size: 1.2rem; font-weight: 400;">
                        Transform your videos into powerful content with AI-powered transcription and script generation
                    </p>
                    <div class="mt-4">
                        <span class="badge" style="
                            background: var(--gradient-primary); 
                            color: white; 
                            padding: 0.5rem 1rem;
                            border-radius: 2rem;
                            font-size: 0.9rem;
                            font-weight: 500;
                        ">
                            ✨ Powered by AI
                        </span>
                    </div>
                </div>

                <!-- Upload Form Card -->
                <div class="card shadow-sm fade-in">
                    <div class="card-header">
                        <h4 class="mb-0 d-flex align-items-center">
                            <span style="margin-right: 0.75rem; font-size: 1.5rem;">🎬</span>
                            Video Upload & Processing
                        </h4>
                    </div>
                    <div class="card-body p-4">
                        <form id="uploadForm">
                            <div class="mb-4">
                                <label class="form-label fw-semibold d-flex align-items-center mb-3" style="color: var(--primary-blue);">
                                    <span style="margin-right: 0.5rem; font-size: 1.2rem;">📁</span>
                                    Select Video File
                                </label>
                                <input 
                                    type="file" 
                                    class="form-control form-control-lg" 
                                    id="videoFile" 
                                    accept=".mp4,video/mp4"
                                    style="
                                        border: 2px dashed var(--primary-rose);
                                        background: rgba(252, 187, 109, 0.05);
                                        transition: all 0.3s ease;
                                    "
                                >
                                <div class="form-text" style="color: var(--primary-slate); font-size: 0.95rem;">
                                    Supported format: MP4 video files only. Max size: 100MB
                                </div>
                                <div id="fileInfo" class="mt-3 p-3" style="
                                    background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
                                    border-radius: 0.75rem;
                                    border: 1px solid #4caf50;
                                    display: none;
                                ">
                                    <small class="d-flex align-items-center" style="color: #2e7d32; font-weight: 500;">
                                        <span style="margin-right: 0.5rem;">✅</span>
                                        <span id="fileDetails"></span>
                                    </small>
                                </div>
                            </div>

                            <div class="d-grid">
                                <button 
                                    type="submit" 
                                    class="btn btn-primary btn-lg fw-semibold" 
                                    id="submitBtn"
                                    style="
                                        font-size: 1.1rem;
                                        padding: 1rem 2rem;
                                        border-radius: 1rem;
                                    "
                                >
                                    <span id="submitText">
                                        <span style="margin-right: 0.5rem;">🚀</span>
                                        Transcribe & Generate Scripts
                                    </span>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Error Alert -->
                <div id="errorAlert" class="alert alert-danger mt-4" style="display: none;">
                    <h5 class="alert-heading">Error</h5>
                    <p class="mb-0" id="errorMessage"></p>
                </div>

                <!-- Results Section -->
                <div id="resultsSection" class="mt-4 fade-in" style="display: none;">
                    <!-- Transcript Section -->
                    <div class="card mb-4 shadow-sm">
                        <div class="card-header" style="background: var(--gradient-secondary);">
                            <h5 class="mb-0 d-flex align-items-center text-white">
                                <span style="margin-right: 0.75rem; font-size: 1.3rem;">📝</span>
                                Transcript
                            </h5>
                        </div>
                        <div class="card-body">
                            <div style="
                                background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
                                padding: 1.5rem;
                                border-radius: 0.75rem;
                                border: 1px solid rgba(171, 108, 130, 0.2);
                            ">
                                <p class="mb-0" id="transcriptContent" style="
                                    white-space: pre-wrap;
                                    color: var(--primary-blue);
                                    line-height: 1.7;
                                    font-size: 1rem;
                                "></p>
                            </div>
                        </div>
                    </div>

                    <!-- Generated Scripts Section -->
                    <div class="card shadow-sm">
                        <div class="card-header" style="background: var(--gradient-primary);">
                            <h5 class="mb-0 d-flex align-items-center text-white">
                                <span style="margin-right: 0.75rem; font-size: 1.3rem;">📄</span>
                                Generated Scripts
                            </h5>
                        </div>
                        <div class="card-body">
                            <div id="scriptsContainer"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // DOM Elements
        const uploadForm = document.getElementById('uploadForm');
        const videoFileInput = document.getElementById('videoFile');
        const fileInfo = document.getElementById('fileInfo');
        const fileDetails = document.getElementById('fileDetails');
        const submitBtn = document.getElementById('submitBtn');
        const submitText = document.getElementById('submitText');
        const errorAlert = document.getElementById('errorAlert');
        const errorMessage = document.getElementById('errorMessage');
        const resultsSection = document.getElementById('resultsSection');
        const transcriptContent = document.getElementById('transcriptContent');
        const scriptsContainer = document.getElementById('scriptsContainer');

        // State
        let selectedFile = null;
        let isLoading = false;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // File input change handler
            videoFileInput.addEventListener('change', handleFileChange);
            
            // Form submit handler
            uploadForm.addEventListener('submit', handleSubmit);
        });

        // File change handler
        function handleFileChange(event) {
            const file = event.target.files[0];
            
            if (file) {
                // Check file size (100MB limit)
                const maxSize = 100 * 1024 * 1024;
                if (file.size > maxSize) {
                    showError('File too large. Maximum size is 100MB.');
                    event.target.value = '';
                    return;
                }
                
                // Check if file is MP4
                if (file.type === 'video/mp4' || file.name.toLowerCase().endsWith('.mp4')) {
                    selectedFile = file;
                    showFileInfo(file);
                    hideError();
                    hideResults();
                } else {
                    showError('Please select an MP4 video file only.');
                    selectedFile = null;
                    hideFileInfo();
                    hideResults();
                    // Clear the file input
                    event.target.value = '';
                }
            } else {
                selectedFile = null;
                hideFileInfo();
                hideResults();
            }
        }

        // Show file info
        function showFileInfo(file) {
            const fileSize = formatFileSize(file.size);
            fileDetails.textContent = `Selected: ${file.name} (${fileSize})`;
            fileInfo.style.display = 'block';
        }

        // Hide file info
        function hideFileInfo() {
            fileInfo.style.display = 'none';
        }

        // Format file size
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // Form submit handler
        async function handleSubmit(event) {
            event.preventDefault();
            
            if (!selectedFile) {
                showError('Please select an MP4 video file');
                return;
            }

            setLoading(true);
            hideError();
            hideResults();

            try {
                const formData = new FormData();
                formData.append('video', selectedFile);

                const response = await fetch('/api/upload', {
                    method: 'POST',
                    body: formData,
                    // Note: Don't set Content-Type header, let browser set it with boundary
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.error || `HTTP error! status: ${response.status}`);
                }

                const result = await response.json();
                showResults(result);
                
            } catch (error) {
                console.error('Upload error:', error);
                
                let errorMsg = 'An unexpected error occurred. Please try again.';
                
                if (error.message.includes('timeout')) {
                    errorMsg = 'Request timeout. The video processing took too long.';
                } else if (error.message) {
                    errorMsg = error.message;
                }
                
                showError(errorMsg);
            } finally {
                setLoading(false);
            }
        }

        // Set loading state
        function setLoading(loading) {
            isLoading = loading;
            
            if (loading) {
                submitBtn.disabled = true;
                submitText.innerHTML = `
                    <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
                    Processing Video...
                `;
            } else {
                submitBtn.disabled = false;
                submitText.innerHTML = `
                    <span style="margin-right: 0.5rem;">🚀</span>
                    Transcribe & Generate Scripts
                `;
            }
        }

        // Show error
        function showError(message) {
            errorMessage.textContent = message;
            errorAlert.style.display = 'block';
        }

        // Hide error
        function hideError() {
            errorAlert.style.display = 'none';
        }

        // Show results
        function showResults(result) {
            // Show transcript
            if (result.transcript) {
                transcriptContent.textContent = result.transcript;
            } else {
                transcriptContent.textContent = 'No transcript available.';
            }

            // Show scripts
            if (result.scripts && result.scripts.length > 0) {
                scriptsContainer.innerHTML = '';
                
                result.scripts.forEach((script, index) => {
                    const scriptCard = createScriptCard(script, index);
                    scriptsContainer.appendChild(scriptCard);
                });
            } else {
                scriptsContainer.innerHTML = `
                    <div class="text-center py-4">
                        <p style="color: var(--primary-slate); font-size: 1.1rem;">
                            No scripts were generated.
                        </p>
                    </div>
                `;
            }

            resultsSection.style.display = 'block';
        }

        // Create script card
        function createScriptCard(script, index) {
            const colDiv = document.createElement('div');
            colDiv.className = 'col-md-6 mb-3';
            
            colDiv.innerHTML = `
                <div class="card script-card h-100">
                    <div class="card-header">
                        <h6 class="mb-0 fw-semibold d-flex align-items-center" style="color: var(--primary-blue);">
                            <span style="margin-right: 0.5rem; font-size: 1.1rem;">✨</span>
                            ${escapeHtml(script.title)}
                        </h6>
                    </div>
                    <div class="card-body">
                        <p class="mb-0" style="white-space: pre-wrap; color: var(--primary-slate); line-height: 1.6;">
                            ${escapeHtml(script.content)}
                        </p>
                    </div>
                </div>
            `;
            
            return colDiv;
        }

        // Hide results
        function hideResults() {
            resultsSection.style.display = 'none';
        }

        // Escape HTML to prevent XSS
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Add drag and drop functionality
        const fileInput = document.getElementById('videoFile');

        fileInput.addEventListener('dragover', function(event) {
            event.preventDefault();
            fileInput.style.borderColor = 'var(--primary-gold)';
            fileInput.style.background = 'rgba(252, 187, 109, 0.1)';
        });

        fileInput.addEventListener('dragleave', function(event) {
            event.preventDefault();
            fileInput.style.borderColor = 'var(--primary-rose)';
            fileInput.style.background = 'rgba(252, 187, 109, 0.05)';
        });

        fileInput.addEventListener('drop', function(event) {
            event.preventDefault();
            fileInput.style.borderColor = 'var(--primary-rose)';
            fileInput.style.background = 'rgba(252, 187, 109, 0.05)';
            
            const files = event.dataTransfer.files;
            if (files.length > 0) {
                videoFileInput.files = files;
                handleFileChange({ target: { files: files } });
            }
        });

        // Add keyboard shortcuts
        document.addEventListener('keydown', function(event) {
            // Escape key to reset form
            if (event.key === 'Escape') {
                resetForm();
            }
        });

        // Reset form function
        function resetForm() {
            uploadForm.reset();
            selectedFile = null;
            hideFileInfo();
            hideError();
            hideResults();
        }
    </script>
</body>
</html>

